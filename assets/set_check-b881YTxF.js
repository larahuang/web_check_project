import{d as oe,g as r,r as g,o as c,a as v,h as o,e as n,w as d,F as V,b as O,c as F,f as H,t as p,k as ve,y as be,z as ge,A as he,u as ye,s as _e,B as xe,i as E,j as ke,p as J,l as N,m as Z,T as ee,E as le,q as te}from"./index-BV0MUO1B.js";import{_ as Ve,a as Se}from"./Pagination.vue_vue_type_script_setup_true_lang-KugMQ-k5.js";const Ce={key:0,class:"modal"},Me=o("i",{class:"fa-solid fa-xmark"},null,-1),Oe=[Me],He={class:"modal-body"},Te=o("span",{class:"text-gray-500"},"-",-1),je=oe({__name:"defultModal",props:{modalWidth:{type:String},isOpenAdd:{type:Boolean},forms:{type:Object,required:!0},rules:{type:Object},modeLists:{type:Object},personGroup:{type:Object},flexibleHourObject:{type:Object}},emits:["sendSelectRadio","sendOpenAddModal","sendCloseAddModal","sendSubmitForm","sendResetForm","sendSelectGroup","sendSelectWorkHour"],setup(a,{emit:w}){const y=r(),_=w,T=()=>{_("sendCloseAddModal")},I=i=>{_("sendSubmitForm",i)},j=i=>{_("sendResetForm",i)},Y=i=>{_("sendSelectRadio",i)},P=i=>{_("sendSelectGroup",i)},S=i=>{_("sendSelectWorkHour",i)};return(i,t)=>{const W=g("el-radio"),u=g("el-radio-group"),f=g("el-form-item"),x=g("el-input"),$=g("el-col"),R=g("el-option"),U=g("el-select"),C=g("el-button"),z=g("el-form");return a.isOpenAdd?(c(),v("div",Ce,[o("div",{class:"modal-main",style:ge({width:a.modalWidth+"px"})},[o("div",{class:"modal-header"},[o("a",{onClick:T},Oe)]),o("div",He,[n(z,{ref_key:"ruleFormRef",ref:y,model:a.forms,rules:a.rules},{default:d(()=>[n(f,{label:"模式",prop:"mode"},{default:d(()=>[n(u,{modelValue:a.forms.mode,"onUpdate:modelValue":t[0]||(t[0]=l=>a.forms.mode=l),onChange:t[1]||(t[1]=l=>{var b;return Y((b=a.forms)==null?void 0:b.mode)})},{default:d(()=>[(c(!0),v(V,null,O(a.modeLists,l=>(c(),F(W,{key:l.mode_id,value:l.mode_id},{default:d(()=>[H(p(l.mode_title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(f,{label:"地點",prop:"name"},{default:d(()=>[n(x,{modelValue:a.forms.name,"onUpdate:modelValue":t[2]||(t[2]=l=>a.forms.name=l)},null,8,["modelValue"])]),_:1}),n(f,{label:"定位地圖網址",prop:"url"},{default:d(()=>[n(x,{modelValue:a.forms.url,"onUpdate:modelValue":t[3]||(t[3]=l=>a.forms.url=l),type:"textarea"},null,8,["modelValue"])]),_:1}),n(f,{label:"座標",prop:"lat"},{default:d(()=>[n($,{span:11},{default:d(()=>[n(f,{prop:"lat"},{default:d(()=>[n(x,{modelValue:a.forms.lat,"onUpdate:modelValue":t[4]||(t[4]=l=>a.forms.lat=l)},null,8,["modelValue"])]),_:1})]),_:1}),n($,{class:"text-center",span:2},{default:d(()=>[Te]),_:1}),n($,{span:11},{default:d(()=>[n(f,{prop:"lng"},{default:d(()=>[n(x,{modelValue:a.forms.lng,"onUpdate:modelValue":t[5]||(t[5]=l=>a.forms.lng=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(f,{label:"距離",prop:"distance"},{default:d(()=>[n(x,{modelValue:a.forms.distance,"onUpdate:modelValue":t[6]||(t[6]=l=>a.forms.distance=l)},null,8,["modelValue"])]),_:1}),n(f,{class:"flexibleTime",label:"彈性時間",prop:"flexibleTime"},{default:d(()=>[ve(o("input",{class:"el-input__inner","onUpdate:modelValue":t[7]||(t[7]=l=>a.forms.flexibleTime=l),type:"time",id:"flexibleTime"},null,512),[[be,a.forms.flexibleTime]])]),_:1}),n(f,{label:"工時",prop:"flexibleHour"},{default:d(()=>[n(U,{modelValue:a.forms.flexibleHour,"onUpdate:modelValue":t[8]||(t[8]=l=>a.forms.flexibleHour=l),onChange:t[9]||(t[9]=l=>{var b;return S((b=a.forms)==null?void 0:b.flexibleHour)}),placeholder:"Select"},{default:d(()=>[(c(!0),v(V,null,O(a.flexibleHourObject,l=>(c(),F(R,{key:l.id,label:l.time,value:l.time},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(f,{label:"權限群組",prop:"personGroup"},{default:d(()=>[n(U,{modelValue:a.forms.personGroup,"onUpdate:modelValue":t[10]||(t[10]=l=>a.forms.personGroup=l),onChange:t[11]||(t[11]=l=>{var b;return P((b=a.forms)==null?void 0:b.personGroup)}),placeholder:"Select"},{default:d(()=>[(c(!0),v(V,null,O(a.personGroup,l=>(c(),F(R,{key:l.mode_id,label:l.person_name,value:l.person_name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(f,{class:"save_btn_group"},{default:d(()=>[n(C,{onClick:t[12]||(t[12]=l=>j(y.value))},{default:d(()=>[H("重置")]),_:1}),n(C,{type:"primary",onClick:t[13]||(t[13]=l=>I(y.value))},{default:d(()=>[H(" 送出 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])])],4)])):he("",!0)}}}),Pe={class:"title"},$e={class:"tableContainer"},De=o("i",{class:"fa-solid fa-plus"},null,-1),Ge={key:0,class:"table-auto w-full"},qe={"data-name":"群組"},Ae={"data-name":"建立日期"},Fe={"data-name":"修改日期"},we=["onClick"],Ie=o("i",{class:"fa-solid fa-pen-to-square"},null,-1),We=["onClick"],Re=o("i",{class:"fa-solid fa-trash-can"},null,-1),Ue={key:1,class:"flex justify-center mt-3"},Le=oe({__name:"set_check",setup(a){const w=ye(),{setCheckModesLists:y,totalCount:_}=_e(w),{getSetCheckModes:T}=w;xe(),r();const I=r("出勤設定");localStorage.setItem("pageName",I.value);const j={"Content-Type":"application/json",Accept:"application/json"},Y=r(["項目","模式","地點","座標","彈性時間","工時","距離","群組","建立時間","修改時間","操作"]),P=r(!1),S=r(""),i=r(""),t=e=>{S.value="550",e._id?i.value=e._id:i.value="",b(e._id),P.value=!0},W=()=>{u.value.mode=u.value.name=u.value.url=u.value.flexibleTime=u.value.flexibleHour=u.value.distance=u.value.lat=u.value.lng="",u.value.personGroup=[],P.value=!1},u=r({_id:"",mode:null,name:"",url:"",flexibleTime:"",flexibleHour:"",distance:null,lat:"",lng:"",personGroup:[],buildDate:null,updataDate:null}),f=r({mode:[{required:!0,message:"請選取模式",trigger:"blur"}],name:[{required:!0,message:"請填寫地點",trigger:"blur"}],url:[{required:!0,message:"請填寫定位地圖",trigger:"blur"}],lat:[{required:!0,message:"請填寫縱座標",trigger:"blur"}],lng:[{required:!0,message:"請填寫橫座標",trigger:"blur"}],flexibleTime:[{required:!0,message:"請選取彈性時間",trigger:"blur"}],flexibleHour:[{required:!0,message:"請選取工時",trigger:"blur"}],distance:[{required:!0,message:"定點距離",trigger:"blur"}],personGroup:[{required:!0,message:"群組",trigger:"blur"}]}),x=r([{mode_id:1,mode_title:"標準模式"},{mode_id:2,mode_title:"彈性模式"}]),$=e=>{console.log(e)},R=r([{person_id:"001",person_name:"管理職"},{person_id:"002",person_name:"一般員工"}]),U=r([{id:"001",time:"1"},{id:"002",time:"1.5"},{id:"003",time:"2"},{id:"004",time:"2.5"},{id:"005",time:"3"},{id:"006",time:"3.5"},{id:"007",time:"4"},{id:"008",time:"4.5"},{id:"009",time:"5"},{id:"010",time:"5.5"},{id:"011",time:"6"},{id:"010",time:"6.5"},{id:"011",time:"7"},{id:"012",time:"7.5"},{id:"013",time:"8"},{id:"014",time:"8.5"},{id:"015",time:"9"},{id:"016",time:"9.5"},{id:"017",time:"10"},{id:"018",time:"10.5"},{id:"019",time:"11"}]),C=r([]),z=e=>{C.value=[],C.value.push(e)},l=e=>{console.log(e)},b=async e=>{try{const m=`https://api-quiz-project.vercel.app/api/setCheckModes/${e}`,G=await fetch(m,{headers:j,method:"GET"});u.value=await G.json()}catch(m){console.log("err",m)}},ae=async e=>{e&&await e.validate(async(m,G)=>{if(m)try{const s={mode:u.value.mode,name:u.value.name,url:u.value.url,lat:u.value.lat,lng:u.value.lng,flexibleTime:u.value.flexibleTime,flexibleHour:u.value.flexibleHour,distance:u.value.distance,personGroup:C.value,buildDate:Date.now(),updataDate:Date.now()};let q="",k="";i.value?(k=`https://api-quiz-project.vercel.app/api/setCheckModes/${i.value}`,q="PUT",s.buildDate=Number(u.value.buildDate)):(k="https://api-quiz-project.vercel.app/api/setCheckMode",q="POST"),await fetch(k,{method:q,headers:j,body:JSON.stringify(s)}).then(A=>A.json()).then(A=>{console.log(A),T(),W()})}catch(s){le.error(s)}else console.log("驗證!",G)})},ne=e=>{e&&e.resetFields()},B=r(!1),se=e=>{S.value="550",e._id?i.value=e._id:i.value="",B.value=!0},Q=()=>{B.value=!1},ue=async()=>{try{const e=`https://api-quiz-project.vercel.app/api/setCheckModes/${i.value}`;await fetch(e,{method:"DELETE",headers:j}).then(m=>m.json()).then(m=>{console.log(m),T(),Q()})}catch(e){le.error(e)}},M=r(""),h=r(1),D=r(10),de=e=>{console.log(e),D.value=e,L.value=e+"筆"},re=r([{value:"10",label:"10筆"},{value:"15",label:"15筆"},{value:"20",label:"20筆"},{value:"30",label:"30筆"},{value:"40",label:"40筆"},{value:"50",label:"50筆"}]),L=r("10筆"),K=E(()=>{let e=y.value;return M.value===""||(M.value=M.value.trim(),e=e.filter(function(m){if(console.log(m),m.name.indexOf(M.value)!==-1)return m})),e}),X=E(()=>Math.ceil(K.value.length/D.value)),ie=r(1),me=E(()=>{const e=h.value*D.value-D.value;return ie.value=e,K.value.slice(e,e+D.value)}),ce=()=>{h.value>1&&h.value--},pe=()=>{h.value<X.value&&h.value++},fe=e=>{e===null?h.value=1:h.value=e};return ke(()=>{T()}),(e,m)=>{const G=g("el-input");return c(),v(V,null,[o("div",null,[o("div",Pe,p(I.value),1),n(G,{class:"mt-3",modelValue:M.value,"onUpdate:modelValue":m[0]||(m[0]=s=>M.value=s)},null,8,["modelValue"])]),o("div",$e,[o("a",{onClick:J(t,["prevent"]),class:"btn bg-green-600 text-white hover:bg-green-800"},[De,H("新增 ")]),N(y).length>0?(c(),v("table",Ge,[o("thead",null,[o("tr",null,[(c(!0),v(V,null,O(Y.value,s=>(c(),v("th",{class:"bg-sky-200 border-sky-600",key:s},p(s),1))),128))])]),o("tbody",null,[(c(!0),v(V,null,O(me.value,(s,q)=>(c(),v("tr",{class:"hover:bg-sky-50 focus:bg-sky-50",key:s._id},[o("td",null,p(q+1),1),o("td",null,p(s.mode),1),o("td",null,p(s.name),1),o("td",null,p(s.lat)+" /"+p(s.lng),1),o("td",null,p(s.flexibleTime),1),o("td",null,p(s.flexibleHour),1),o("td",null,p(s.distance),1),o("td",qe,[(c(!0),v(V,null,O(s.personGroup,(k,A)=>(c(),v("span",{key:A},p(k)+", ",1))),128))]),o("td",Ae,p(N(Z)(s.buildDate).format("YYYY-MM-DD THH:mm")),1),o("td",Fe,p(N(Z)(s.updataDate).format("YYYY-MM-DD THH:mm")),1),o("td",null,[o("a",{onClick:J(k=>t(s),["prevent"]),class:"btn bg-amber-500 text-white hover:bg-amber-800"},[Ie,H(" 編輯 ")],8,we),o("a",{onClick:J(k=>se(s),["prevent"]),class:"btn bg-red-500 text-white hover:bg-red-800"},[Re,H(" 刪除 ")],8,We)])]))),128))])])):(c(),v("div",Ue,"沒有數據，新增吧"))]),n(Ve,{currentPage:h.value,onSendPrevPage:ce,totalPages:X.value,onSendItActive:fe,sendNextPage:pe,totalItem:N(y).length,onSendChangeItemsPerPage:de,pageValue:L.value,modelValue:L.value,"onUpdate:modelValue":m[1]||(m[1]=s=>L.value=s),pagePerOptions:re.value},null,8,["currentPage","totalPages","totalItem","pageValue","modelValue","pagePerOptions"]),(c(),F(ee,{to:"body"},[n(je,{isOpenAdd:P.value,forms:u.value,modeLists:x.value,modalWidth:S.value,personGroup:R.value,flexibleHourObject:U.value,rules:f.value,onSendSelectRadio:$,onSendOpenAddModal:t,onSendCloseAddModal:W,onSendSubmitForm:ae,onSendResetForm:ne,onSendSelectWorkHour:l,onSendSelectGroup:z},null,8,["isOpenAdd","forms","modeLists","modalWidth","personGroup","flexibleHourObject","rules"])])),(c(),F(ee,{to:"body"},[n(Se,{isOpen:B.value,modalWidth:S.value,onSendCloseModal:Q,onSendDeleteModeItem:ue},null,8,["isOpen","modalWidth"])]))],64)}}});typeof te=="function"&&te(Le);export{Le as default};
