import{d as se,h as u,r as b,o as c,a as v,b as t,f as s,w as r,F as k,e as T,c as F,g as O,t as f,l as ye,B as xe,C as ke,D as Se,u as Ve,i as Ce,s as ee,G as Me,j as E,k as Te,q as J,m as U,p as le,T as te,E as oe,x as ae}from"./index-Vvt8a9So.js";import{_ as Oe,a as Pe}from"./Pagination.vue_vue_type_script_setup_true_lang-ZdeptEDG.js";const He={key:0,class:"modal"},je=t("i",{class:"fa-solid fa-xmark"},null,-1),De=[je],Ge={class:"modal-body"},$e=t("span",{class:"text-gray-500"},"-",-1),qe=se({__name:"defultModal",props:{modalWidth:{type:String},isOpenAdd:{type:Boolean},forms:{type:Object,required:!0},rules:{type:Object},modeLists:{type:Object},personGroup:{type:Object},flexibleHourObject:{type:Object}},emits:["sendSelectRadio","sendOpenAddModal","sendCloseAddModal","sendSubmitForm","sendResetForm","sendSelectGroup","sendSelectWorkHour"],setup(a,{emit:w}){const S=u(),_=w,L=()=>{_("sendCloseAddModal")},P=p=>{_("sendSubmitForm",p)},Q=p=>{_("sendResetForm",p)},H=p=>{_("sendSelectRadio",p)},N=p=>{_("sendSelectGroup",p)},j=p=>{_("sendSelectWorkHour",p)};return(p,o)=>{const D=b("el-radio"),V=b("el-radio-group"),i=b("el-form-item"),h=b("el-input"),C=b("el-col"),d=b("el-option"),I=b("el-select"),W=b("el-button"),Y=b("el-form");return a.isOpenAdd?(c(),v("div",He,[t("div",{class:"modal-main",style:ke({width:a.modalWidth+"px"})},[t("div",{class:"modal-header"},[t("a",{onClick:L},De)]),t("div",Ge,[s(Y,{ref_key:"ruleFormRef",ref:S,model:a.forms,rules:a.rules},{default:r(()=>[s(i,{label:"模式",prop:"mode"},{default:r(()=>[s(V,{modelValue:a.forms.mode,"onUpdate:modelValue":o[0]||(o[0]=l=>a.forms.mode=l),onChange:o[1]||(o[1]=l=>{var g;return H((g=a.forms)==null?void 0:g.mode)})},{default:r(()=>[(c(!0),v(k,null,T(a.modeLists,l=>(c(),F(D,{key:l.mode_id,value:l.mode_id},{default:r(()=>[O(f(l.mode_title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(i,{label:"地點",prop:"name"},{default:r(()=>[s(h,{modelValue:a.forms.name,"onUpdate:modelValue":o[2]||(o[2]=l=>a.forms.name=l)},null,8,["modelValue"])]),_:1}),s(i,{label:"定位地圖網址",prop:"url"},{default:r(()=>[s(h,{modelValue:a.forms.url,"onUpdate:modelValue":o[3]||(o[3]=l=>a.forms.url=l),type:"textarea"},null,8,["modelValue"])]),_:1}),s(i,{label:"座標",prop:"lat"},{default:r(()=>[s(C,{span:11},{default:r(()=>[s(i,{prop:"lat"},{default:r(()=>[s(h,{modelValue:a.forms.lat,"onUpdate:modelValue":o[4]||(o[4]=l=>a.forms.lat=l)},null,8,["modelValue"])]),_:1})]),_:1}),s(C,{class:"text-center",span:2},{default:r(()=>[$e]),_:1}),s(C,{span:11},{default:r(()=>[s(i,{prop:"lng"},{default:r(()=>[s(h,{modelValue:a.forms.lng,"onUpdate:modelValue":o[5]||(o[5]=l=>a.forms.lng=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(i,{label:"距離",prop:"distance"},{default:r(()=>[s(h,{modelValue:a.forms.distance,"onUpdate:modelValue":o[6]||(o[6]=l=>a.forms.distance=l)},null,8,["modelValue"])]),_:1}),s(i,{class:"flexibleTime",label:"彈性時間",prop:"flexibleTime"},{default:r(()=>[ye(t("input",{class:"el-input__inner","onUpdate:modelValue":o[7]||(o[7]=l=>a.forms.flexibleTime=l),type:"time",id:"flexibleTime"},null,512),[[xe,a.forms.flexibleTime]])]),_:1}),s(i,{label:"工時",prop:"flexibleHour"},{default:r(()=>[s(I,{modelValue:a.forms.flexibleHour,"onUpdate:modelValue":o[8]||(o[8]=l=>a.forms.flexibleHour=l),onChange:o[9]||(o[9]=l=>{var g;return j((g=a.forms)==null?void 0:g.flexibleHour)}),placeholder:"Select"},{default:r(()=>[(c(!0),v(k,null,T(a.flexibleHourObject,l=>(c(),F(d,{key:l.id,label:l.time,value:l.time},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(i,{label:"權限群組",prop:"personGroup"},{default:r(()=>[s(I,{modelValue:a.forms.personGroup,"onUpdate:modelValue":o[10]||(o[10]=l=>a.forms.personGroup=l),onChange:o[11]||(o[11]=l=>{var g;return N((g=a.forms)==null?void 0:g.personGroup)}),placeholder:"Select"},{default:r(()=>[(c(!0),v(k,null,T(a.personGroup,l=>(c(),F(d,{key:l.mode_id,label:l.person_name,value:l.person_name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(i,{class:"save_btn_group"},{default:r(()=>[s(W,{onClick:o[12]||(o[12]=l=>Q(S.value))},{default:r(()=>[O("重置")]),_:1}),s(W,{type:"primary",onClick:o[13]||(o[13]=l=>P(S.value))},{default:r(()=>[O(" 送出 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])])],4)])):Se("",!0)}}}),Ae={class:"title"},Fe={class:"tableContainer"},we=t("i",{class:"fa-solid fa-plus"},null,-1),Ie={key:0,class:"table w-full"},We={"data-title":"模式"},Re={"data-title":"地點"},Ue={"data-title":"座標"},Le={"data-title":"彈性時間"},Ne={"data-title":"工時"},Ye={"data-title":"距離"},Be={"data-title":"群組"},ze={"data-title":"建立日期"},Ee={"data-title":"修改日期"},Je=["onClick"],Qe=t("i",{class:"fa-solid fa-pen-to-square"},null,-1),Ke=["onClick"],Xe=t("i",{class:"fa-solid fa-trash-can"},null,-1),Ze={key:1,class:"flex justify-center mt-3"},el=se({__name:"set_check",setup(a){const w=Ve(),S=Ce();ee(w);const{getPageClass:_,changeTitleTag:L}=w,{setCheckModesLists:P,totalCount:Q}=ee(S),{getSetCheckModes:H}=S;Me(),u(),u("出勤設定");const N=u("pageCheckSet");localStorage.setItem("pageClass",N.value);const j=u("出勤設定");localStorage.setItem("pageName",j.value);const p={"Content-Type":"application/json",Accept:"application/json"},o=u(["項目","模式","地點","座標","彈性時間","工時","距離","群組","建立時間","修改時間","操作"]),D=u(!1),V=u(""),i=u(""),h=e=>{V.value="550",e._id?i.value=e._id:i.value="",ue(e._id),D.value=!0},C=()=>{d.value.mode=d.value.name=d.value.url=d.value.flexibleTime=d.value.flexibleHour=d.value.distance=d.value.lat=d.value.lng="",d.value.personGroup=[],D.value=!1},d=u({_id:"",mode:null,name:"",url:"",flexibleTime:"",flexibleHour:"",distance:null,lat:"",lng:"",personGroup:[],buildDate:null,updataDate:null}),I=u({mode:[{required:!0,message:"請選取模式",trigger:"blur"}],name:[{required:!0,message:"請填寫地點",trigger:"blur"}],url:[{required:!0,message:"請填寫定位地圖",trigger:"blur"}],lat:[{required:!0,message:"請填寫縱座標",trigger:"blur"}],lng:[{required:!0,message:"請填寫橫座標",trigger:"blur"}],flexibleTime:[{required:!0,message:"請選取彈性時間",trigger:"blur"}],flexibleHour:[{required:!0,message:"請選取工時",trigger:"blur"}],distance:[{required:!0,message:"定點距離",trigger:"blur"}],personGroup:[{required:!0,message:"群組",trigger:"blur"}]}),W=u([{mode_id:1,mode_title:"標準模式"},{mode_id:2,mode_title:"彈性模式"}]),Y=e=>{console.log(e)},l=u([{person_id:"001",person_name:"管理職"},{person_id:"002",person_name:"一般員工"}]),g=u([{id:"001",time:"1"},{id:"002",time:"1.5"},{id:"003",time:"2"},{id:"004",time:"2.5"},{id:"005",time:"3"},{id:"006",time:"3.5"},{id:"007",time:"4"},{id:"008",time:"4.5"},{id:"009",time:"5"},{id:"010",time:"5.5"},{id:"011",time:"6"},{id:"010",time:"6.5"},{id:"011",time:"7"},{id:"012",time:"7.5"},{id:"013",time:"8"},{id:"014",time:"8.5"},{id:"015",time:"9"},{id:"016",time:"9.5"},{id:"017",time:"10"},{id:"018",time:"10.5"},{id:"019",time:"11"}]),B=u([]),ne=e=>{B.value=[],B.value.push(e)},de=e=>{console.log(e)},ue=async e=>{try{const m=`https://api-quiz-project.vercel.app/api/setCheckModes/${e}`,$=await fetch(m,{headers:p,method:"GET"});d.value=await $.json()}catch(m){console.log("err",m)}},re=async e=>{e&&await e.validate(async(m,$)=>{if(m)try{const n={mode:d.value.mode,name:d.value.name,url:d.value.url,lat:d.value.lat,lng:d.value.lng,flexibleTime:d.value.flexibleTime,flexibleHour:d.value.flexibleHour,distance:d.value.distance,personGroup:B.value,buildDate:Date.now(),updataDate:Date.now()};let q="",x="";i.value?(x=`https://api-quiz-project.vercel.app/api/setCheckModes/${i.value}`,q="PUT",n.buildDate=Number(d.value.buildDate)):(x="https://api-quiz-project.vercel.app/api/setCheckMode",q="POST"),await fetch(x,{method:q,headers:p,body:JSON.stringify(n)}).then(A=>A.json()).then(A=>{console.log(A),H(),C()})}catch(n){oe.error(n)}else console.log("驗證!",$)})},ie=e=>{e&&e.resetFields()},z=u(!1),me=e=>{V.value="550",e._id?i.value=e._id:i.value="",z.value=!0},K=()=>{z.value=!1},ce=async()=>{try{const e=`https://api-quiz-project.vercel.app/api/setCheckModes/${i.value}`;await fetch(e,{method:"DELETE",headers:p}).then(m=>m.json()).then(m=>{console.log(m),H(),K()})}catch(e){oe.error(e)}},M=u(""),y=u(1),G=u(10),pe=e=>{console.log(e),G.value=e,R.value=e+"筆"},fe=u([{value:"10",label:"10筆"},{value:"15",label:"15筆"},{value:"20",label:"20筆"},{value:"30",label:"30筆"},{value:"40",label:"40筆"},{value:"50",label:"50筆"}]),R=u("10筆"),X=E(()=>{let e=P.value;return M.value===""||(M.value=M.value.trim(),e=e.filter(function(m){if(console.log(m),m.name.indexOf(M.value)!==-1)return m})),e}),Z=E(()=>Math.ceil(X.value.length/G.value)),ve=u(1),ge=E(()=>{const e=y.value*G.value-G.value;return ve.value=e,X.value.slice(e,e+G.value)}),be=()=>{y.value>1&&y.value--},he=()=>{y.value<Z.value&&y.value++},_e=e=>{e===null?y.value=1:y.value=e};return Te(()=>{_(),L(j.value),H()}),(e,m)=>{const $=b("el-input");return c(),v(k,null,[t("div",null,[t("div",Ae,[t("b",null,f(j.value),1)]),s($,{class:"mt-3",modelValue:M.value,"onUpdate:modelValue":m[0]||(m[0]=n=>M.value=n)},null,8,["modelValue"])]),t("div",Fe,[t("a",{onClick:J(h,["prevent"]),class:"btn bg-green-600 text-white hover:bg-green-800"},[we,O("新增 ")]),U(P).length>0?(c(),v("table",Ie,[t("thead",null,[t("tr",null,[(c(!0),v(k,null,T(o.value,n=>(c(),v("th",{class:"bg-sky-200 border-sky-600",key:n},f(n),1))),128))])]),t("tbody",null,[(c(!0),v(k,null,T(ge.value,(n,q)=>(c(),v("tr",{class:"hover:bg-sky-50 focus:bg-sky-50",key:n._id},[t("td",null,f(q+1),1),t("td",We,f(n.mode),1),t("td",Re,f(n.name),1),t("td",Ue,f(n.lat)+" /"+f(n.lng),1),t("td",Le,f(n.flexibleTime),1),t("td",Ne,f(n.flexibleHour),1),t("td",Ye,f(n.distance),1),t("td",Be,[(c(!0),v(k,null,T(n.personGroup,(x,A)=>(c(),v("span",{key:A},f(x)+", ",1))),128))]),t("td",ze,f(U(le)(n.buildDate).format("YYYY-MM-DD THH:mm")),1),t("td",Ee,f(U(le)(n.updataDate).format("YYYY-MM-DD THH:mm")),1),t("td",null,[t("a",{onClick:J(x=>h(n),["prevent"]),class:"btn bg-amber-500 text-white hover:bg-amber-800"},[Qe,O(" 編輯 ")],8,Je),t("a",{onClick:J(x=>me(n),["prevent"]),class:"btn bg-red-500 text-white hover:bg-red-800"},[Xe,O(" 刪除 ")],8,Ke)])]))),128))])])):(c(),v("div",Ze,"沒有數據，新增吧"))]),s(Oe,{currentPage:y.value,onSendPrevPage:be,totalPages:Z.value,onSendItActive:_e,sendNextPage:he,totalItem:U(P).length,onSendChangeItemsPerPage:pe,pageValue:R.value,modelValue:R.value,"onUpdate:modelValue":m[1]||(m[1]=n=>R.value=n),pagePerOptions:fe.value},null,8,["currentPage","totalPages","totalItem","pageValue","modelValue","pagePerOptions"]),(c(),F(te,{to:"body"},[s(qe,{isOpenAdd:D.value,forms:d.value,modeLists:W.value,modalWidth:V.value,personGroup:l.value,flexibleHourObject:g.value,rules:I.value,onSendSelectRadio:Y,onSendOpenAddModal:h,onSendCloseAddModal:C,onSendSubmitForm:re,onSendResetForm:ie,onSendSelectWorkHour:de,onSendSelectGroup:ne},null,8,["isOpenAdd","forms","modeLists","modalWidth","personGroup","flexibleHourObject","rules"])])),(c(),F(te,{to:"body"},[s(Pe,{isOpen:z.value,modalWidth:V.value,onSendCloseModal:K,onSendDeleteModeItem:ce},null,8,["isOpen","modalWidth"])]))],64)}}});typeof ae=="function"&&ae(el);export{el as default};
