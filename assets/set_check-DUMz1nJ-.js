import{d as oe,h as r,r as g,o as c,a as v,b as o,f as s,w as u,F as V,e as O,c as F,g as H,t as p,k as ve,A as be,B as ge,C as _e,u as he,s as ye,D as xe,i as E,j as ke,p as J,l as N,m as Z,T as ee,E as le,q as te}from"./index-D7nSZ4_P.js";import{_ as Ve,a as Se}from"./Pagination.vue_vue_type_script_setup_true_lang-DrHcWidN.js";const Ce={key:0,class:"modal"},Me=o("i",{class:"fa-solid fa-xmark"},null,-1),Oe=[Me],He={class:"modal-body"},Te=o("span",{class:"text-gray-500"},"-",-1),je=oe({__name:"defultModal",props:{modalWidth:{type:String},isOpenAdd:{type:Boolean},forms:{type:Object,required:!0},rules:{type:Object},modeLists:{type:Object},personGroup:{type:Object},flexibleHourObject:{type:Object}},emits:["sendSelectRadio","sendOpenAddModal","sendCloseAddModal","sendSubmitForm","sendResetForm","sendSelectGroup","sendSelectWorkHour"],setup(a,{emit:w}){const h=r(),y=w,T=()=>{y("sendCloseAddModal")},I=i=>{y("sendSubmitForm",i)},j=i=>{y("sendResetForm",i)},Y=i=>{y("sendSelectRadio",i)},D=i=>{y("sendSelectGroup",i)},S=i=>{y("sendSelectWorkHour",i)};return(i,t)=>{const W=g("el-radio"),d=g("el-radio-group"),f=g("el-form-item"),x=g("el-input"),P=g("el-col"),R=g("el-option"),U=g("el-select"),C=g("el-button"),B=g("el-form");return a.isOpenAdd?(c(),v("div",Ce,[o("div",{class:"modal-main",style:ge({width:a.modalWidth+"px"})},[o("div",{class:"modal-header"},[o("a",{onClick:T},Oe)]),o("div",He,[s(B,{ref_key:"ruleFormRef",ref:h,model:a.forms,rules:a.rules},{default:u(()=>[s(f,{label:"模式",prop:"mode"},{default:u(()=>[s(d,{modelValue:a.forms.mode,"onUpdate:modelValue":t[0]||(t[0]=l=>a.forms.mode=l),onChange:t[1]||(t[1]=l=>{var b;return Y((b=a.forms)==null?void 0:b.mode)})},{default:u(()=>[(c(!0),v(V,null,O(a.modeLists,l=>(c(),F(W,{key:l.mode_id,value:l.mode_id},{default:u(()=>[H(p(l.mode_title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(f,{label:"地點",prop:"name"},{default:u(()=>[s(x,{modelValue:a.forms.name,"onUpdate:modelValue":t[2]||(t[2]=l=>a.forms.name=l)},null,8,["modelValue"])]),_:1}),s(f,{label:"定位地圖網址",prop:"url"},{default:u(()=>[s(x,{modelValue:a.forms.url,"onUpdate:modelValue":t[3]||(t[3]=l=>a.forms.url=l),type:"textarea"},null,8,["modelValue"])]),_:1}),s(f,{label:"座標",prop:"lat"},{default:u(()=>[s(P,{span:11},{default:u(()=>[s(f,{prop:"lat"},{default:u(()=>[s(x,{modelValue:a.forms.lat,"onUpdate:modelValue":t[4]||(t[4]=l=>a.forms.lat=l)},null,8,["modelValue"])]),_:1})]),_:1}),s(P,{class:"text-center",span:2},{default:u(()=>[Te]),_:1}),s(P,{span:11},{default:u(()=>[s(f,{prop:"lng"},{default:u(()=>[s(x,{modelValue:a.forms.lng,"onUpdate:modelValue":t[5]||(t[5]=l=>a.forms.lng=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(f,{label:"距離",prop:"distance"},{default:u(()=>[s(x,{modelValue:a.forms.distance,"onUpdate:modelValue":t[6]||(t[6]=l=>a.forms.distance=l)},null,8,["modelValue"])]),_:1}),s(f,{class:"flexibleTime",label:"彈性時間",prop:"flexibleTime"},{default:u(()=>[ve(o("input",{class:"el-input__inner","onUpdate:modelValue":t[7]||(t[7]=l=>a.forms.flexibleTime=l),type:"time",id:"flexibleTime"},null,512),[[be,a.forms.flexibleTime]])]),_:1}),s(f,{label:"工時",prop:"flexibleHour"},{default:u(()=>[s(U,{modelValue:a.forms.flexibleHour,"onUpdate:modelValue":t[8]||(t[8]=l=>a.forms.flexibleHour=l),onChange:t[9]||(t[9]=l=>{var b;return S((b=a.forms)==null?void 0:b.flexibleHour)}),placeholder:"Select"},{default:u(()=>[(c(!0),v(V,null,O(a.flexibleHourObject,l=>(c(),F(R,{key:l.id,label:l.time,value:l.time},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(f,{label:"權限群組",prop:"personGroup"},{default:u(()=>[s(U,{modelValue:a.forms.personGroup,"onUpdate:modelValue":t[10]||(t[10]=l=>a.forms.personGroup=l),onChange:t[11]||(t[11]=l=>{var b;return D((b=a.forms)==null?void 0:b.personGroup)}),placeholder:"Select"},{default:u(()=>[(c(!0),v(V,null,O(a.personGroup,l=>(c(),F(R,{key:l.mode_id,label:l.person_name,value:l.person_name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(f,{class:"save_btn_group"},{default:u(()=>[s(C,{onClick:t[12]||(t[12]=l=>j(h.value))},{default:u(()=>[H("重置")]),_:1}),s(C,{type:"primary",onClick:t[13]||(t[13]=l=>I(h.value))},{default:u(()=>[H(" 送出 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])])],4)])):_e("",!0)}}}),De={class:"title"},Pe={class:"tableContainer"},$e=o("i",{class:"fa-solid fa-plus"},null,-1),Ge={key:0,class:"table w-full"},qe={"data-title":"模式"},Ae={"data-title":"地點"},Fe={"data-title":"座標"},we={"data-title":"彈性時間"},Ie={"data-title":"工時"},We={"data-title":"距離"},Re={"data-title":"群組"},Ue={"data-title":"建立日期"},Le={"data-title":"修改日期"},Ne=["onClick"],Ye=o("i",{class:"fa-solid fa-pen-to-square"},null,-1),Be=["onClick"],ze=o("i",{class:"fa-solid fa-trash-can"},null,-1),Ee={key:1,class:"flex justify-center mt-3"},Je=oe({__name:"set_check",setup(a){const w=he(),{setCheckModesLists:h,totalCount:y}=ye(w),{getSetCheckModes:T}=w;xe(),r();const I=r("出勤設定");localStorage.setItem("pageName",I.value);const j={"Content-Type":"application/json",Accept:"application/json"},Y=r(["項目","模式","地點","座標","彈性時間","工時","距離","群組","建立時間","修改時間","操作"]),D=r(!1),S=r(""),i=r(""),t=e=>{S.value="550",e._id?i.value=e._id:i.value="",b(e._id),D.value=!0},W=()=>{d.value.mode=d.value.name=d.value.url=d.value.flexibleTime=d.value.flexibleHour=d.value.distance=d.value.lat=d.value.lng="",d.value.personGroup=[],D.value=!1},d=r({_id:"",mode:null,name:"",url:"",flexibleTime:"",flexibleHour:"",distance:null,lat:"",lng:"",personGroup:[],buildDate:null,updataDate:null}),f=r({mode:[{required:!0,message:"請選取模式",trigger:"blur"}],name:[{required:!0,message:"請填寫地點",trigger:"blur"}],url:[{required:!0,message:"請填寫定位地圖",trigger:"blur"}],lat:[{required:!0,message:"請填寫縱座標",trigger:"blur"}],lng:[{required:!0,message:"請填寫橫座標",trigger:"blur"}],flexibleTime:[{required:!0,message:"請選取彈性時間",trigger:"blur"}],flexibleHour:[{required:!0,message:"請選取工時",trigger:"blur"}],distance:[{required:!0,message:"定點距離",trigger:"blur"}],personGroup:[{required:!0,message:"群組",trigger:"blur"}]}),x=r([{mode_id:1,mode_title:"標準模式"},{mode_id:2,mode_title:"彈性模式"}]),P=e=>{console.log(e)},R=r([{person_id:"001",person_name:"管理職"},{person_id:"002",person_name:"一般員工"}]),U=r([{id:"001",time:"1"},{id:"002",time:"1.5"},{id:"003",time:"2"},{id:"004",time:"2.5"},{id:"005",time:"3"},{id:"006",time:"3.5"},{id:"007",time:"4"},{id:"008",time:"4.5"},{id:"009",time:"5"},{id:"010",time:"5.5"},{id:"011",time:"6"},{id:"010",time:"6.5"},{id:"011",time:"7"},{id:"012",time:"7.5"},{id:"013",time:"8"},{id:"014",time:"8.5"},{id:"015",time:"9"},{id:"016",time:"9.5"},{id:"017",time:"10"},{id:"018",time:"10.5"},{id:"019",time:"11"}]),C=r([]),B=e=>{C.value=[],C.value.push(e)},l=e=>{console.log(e)},b=async e=>{try{const m=`https://api-quiz-project.vercel.app/api/setCheckModes/${e}`,G=await fetch(m,{headers:j,method:"GET"});d.value=await G.json()}catch(m){console.log("err",m)}},ae=async e=>{e&&await e.validate(async(m,G)=>{if(m)try{const n={mode:d.value.mode,name:d.value.name,url:d.value.url,lat:d.value.lat,lng:d.value.lng,flexibleTime:d.value.flexibleTime,flexibleHour:d.value.flexibleHour,distance:d.value.distance,personGroup:C.value,buildDate:Date.now(),updataDate:Date.now()};let q="",k="";i.value?(k=`https://api-quiz-project.vercel.app/api/setCheckModes/${i.value}`,q="PUT",n.buildDate=Number(d.value.buildDate)):(k="https://api-quiz-project.vercel.app/api/setCheckMode",q="POST"),await fetch(k,{method:q,headers:j,body:JSON.stringify(n)}).then(A=>A.json()).then(A=>{console.log(A),T(),W()})}catch(n){le.error(n)}else console.log("驗證!",G)})},se=e=>{e&&e.resetFields()},z=r(!1),ne=e=>{S.value="550",e._id?i.value=e._id:i.value="",z.value=!0},Q=()=>{z.value=!1},de=async()=>{try{const e=`https://api-quiz-project.vercel.app/api/setCheckModes/${i.value}`;await fetch(e,{method:"DELETE",headers:j}).then(m=>m.json()).then(m=>{console.log(m),T(),Q()})}catch(e){le.error(e)}},M=r(""),_=r(1),$=r(10),ue=e=>{console.log(e),$.value=e,L.value=e+"筆"},re=r([{value:"10",label:"10筆"},{value:"15",label:"15筆"},{value:"20",label:"20筆"},{value:"30",label:"30筆"},{value:"40",label:"40筆"},{value:"50",label:"50筆"}]),L=r("10筆"),K=E(()=>{let e=h.value;return M.value===""||(M.value=M.value.trim(),e=e.filter(function(m){if(console.log(m),m.name.indexOf(M.value)!==-1)return m})),e}),X=E(()=>Math.ceil(K.value.length/$.value)),ie=r(1),me=E(()=>{const e=_.value*$.value-$.value;return ie.value=e,K.value.slice(e,e+$.value)}),ce=()=>{_.value>1&&_.value--},pe=()=>{_.value<X.value&&_.value++},fe=e=>{e===null?_.value=1:_.value=e};return ke(()=>{T()}),(e,m)=>{const G=g("el-input");return c(),v(V,null,[o("div",null,[o("div",De,[o("b",null,p(I.value),1)]),s(G,{class:"mt-3",modelValue:M.value,"onUpdate:modelValue":m[0]||(m[0]=n=>M.value=n)},null,8,["modelValue"])]),o("div",Pe,[o("a",{onClick:J(t,["prevent"]),class:"btn bg-green-600 text-white hover:bg-green-800"},[$e,H("新增 ")]),N(h).length>0?(c(),v("table",Ge,[o("thead",null,[o("tr",null,[(c(!0),v(V,null,O(Y.value,n=>(c(),v("th",{class:"bg-sky-200 border-sky-600",key:n},p(n),1))),128))])]),o("tbody",null,[(c(!0),v(V,null,O(me.value,(n,q)=>(c(),v("tr",{class:"hover:bg-sky-50 focus:bg-sky-50",key:n._id},[o("td",null,p(q+1),1),o("td",qe,p(n.mode),1),o("td",Ae,p(n.name),1),o("td",Fe,p(n.lat)+" /"+p(n.lng),1),o("td",we,p(n.flexibleTime),1),o("td",Ie,p(n.flexibleHour),1),o("td",We,p(n.distance),1),o("td",Re,[(c(!0),v(V,null,O(n.personGroup,(k,A)=>(c(),v("span",{key:A},p(k)+", ",1))),128))]),o("td",Ue,p(N(Z)(n.buildDate).format("YYYY-MM-DD THH:mm")),1),o("td",Le,p(N(Z)(n.updataDate).format("YYYY-MM-DD THH:mm")),1),o("td",null,[o("a",{onClick:J(k=>t(n),["prevent"]),class:"btn bg-amber-500 text-white hover:bg-amber-800"},[Ye,H(" 編輯 ")],8,Ne),o("a",{onClick:J(k=>ne(n),["prevent"]),class:"btn bg-red-500 text-white hover:bg-red-800"},[ze,H(" 刪除 ")],8,Be)])]))),128))])])):(c(),v("div",Ee,"沒有數據，新增吧"))]),s(Ve,{currentPage:_.value,onSendPrevPage:ce,totalPages:X.value,onSendItActive:fe,sendNextPage:pe,totalItem:N(h).length,onSendChangeItemsPerPage:ue,pageValue:L.value,modelValue:L.value,"onUpdate:modelValue":m[1]||(m[1]=n=>L.value=n),pagePerOptions:re.value},null,8,["currentPage","totalPages","totalItem","pageValue","modelValue","pagePerOptions"]),(c(),F(ee,{to:"body"},[s(je,{isOpenAdd:D.value,forms:d.value,modeLists:x.value,modalWidth:S.value,personGroup:R.value,flexibleHourObject:U.value,rules:f.value,onSendSelectRadio:P,onSendOpenAddModal:t,onSendCloseAddModal:W,onSendSubmitForm:ae,onSendResetForm:se,onSendSelectWorkHour:l,onSendSelectGroup:B},null,8,["isOpenAdd","forms","modeLists","modalWidth","personGroup","flexibleHourObject","rules"])])),(c(),F(ee,{to:"body"},[s(Se,{isOpen:z.value,modalWidth:S.value,onSendCloseModal:Q,onSendDeleteModeItem:de},null,8,["isOpen","modalWidth"])]))],64)}}});typeof te=="function"&&te(Je);export{Je as default};
